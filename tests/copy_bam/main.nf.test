nextflow_process {

    name "Test Process COPY_BAM"
    script "./main.nf"
    process "COPY_BAM"

    test("bam header") {

        when {
            process {
                """
                input[0] = file("${baseDir}/tests/test.paired_end.bam", checkIfExists:true)
                """
            }
        }

        then {
            assert snapshot(path(process.out.bam.get(0)).getBamHeader()).match("header")
        }

    }

    test("bam reads") {

        when {
            process {
                """
                input[0] = file("${baseDir}/tests/test.paired_end.bam", checkIfExists:true)
                """
            }
        }

        then {
            assert snapshot(path(process.out.bam.get(0)).getBamReads()).match("reads")
        }

    }

}
